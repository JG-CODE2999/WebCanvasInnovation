{% extends "base.html" %}

{% block title %}Edit Post | TechBlog{% endblock %}

{% block content %}
<div class="container">
  <div class="row justify-content-center">
    <div class="col-lg-10">
      <div class="card">
        <div class="card-header bg-primary text-white">
          <h5 class="mb-0"><i class="fas fa-edit me-2"></i>Edit Post</h5>
        </div>
        <div class="card-body">
          <form method="post" action="{{ url_for('edit_post', post_id=post.id) }}" class="needs-validation" novalidate>
            <div class="mb-3">
              <label for="title" class="form-label">Title</label>
              <input type="text" class="form-control" id="title" name="title" 
                    value="{{ post.title }}" placeholder="Post title" required>
              <div class="invalid-feedback">
                Please provide a title for your post.
              </div>
            </div>
            
            <div class="mb-3">
              <label for="summary" class="form-label">Summary (optional)</label>
              <textarea class="form-control" id="summary" name="summary" rows="2" 
                       placeholder="A brief summary of your post">{{ post.summary }}</textarea>
              <div class="form-text">A short description that will be displayed on the post list.</div>
            </div>
            
            <div class="mb-3">
              <label for="feature_image" class="form-label">Featured Image URL (optional)</label>
              <input type="url" class="form-control" id="feature_image" name="feature_image" 
                    value="{{ post.feature_image }}" placeholder="https://example.com/image.jpg">
              <div class="form-text">Provide a URL to an image that represents your post.</div>
            </div>
            
            <div class="mb-3">
              <label for="categories" class="form-label">Categories</label>
              <select class="form-select" id="categories" name="categories" multiple>
                {% for category in categories %}
                <option value="{{ category.id }}" 
                        {% if category in post.categories %}selected{% endif %}>
                  {{ category.name }}
                </option>
                {% endfor %}
              </select>
              <div class="form-text">Hold Ctrl/Cmd to select multiple categories.</div>
            </div>
            
            <div class="mb-4">
              <label for="content" class="form-label">Content</label>
              <textarea class="form-control content-editor auto-resize" id="content" name="content" rows="15" 
                       placeholder="Write your post content here..." required>{{ post.content }}</textarea>
              <div class="invalid-feedback">
                Please provide content for your post.
              </div>
              <div class="form-text mt-2">
                <i class="fas fa-info-circle me-1"></i> HTML formatting is supported.
              </div>
            </div>
            
            <div class="d-flex justify-content-between">
              <a href="{{ url_for('post', post_id=post.id) }}" class="btn btn-outline-secondary">Cancel</a>
              <button type="submit" class="btn btn-primary px-4">
                <i class="fas fa-save me-2"></i>Save Changes
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Auto-resize textarea on load
    const textarea = document.getElementById('content');
    if (textarea) {
      textarea.style.height = 'auto';
      textarea.style.height = (textarea.scrollHeight) + 'px';
      
      textarea.addEventListener('input', function() {
        this.style.height = 'auto';
        this.style.height = (this.scrollHeight) + 'px';
      });
    }
  });
</script>
{% endblock %}
